<!DOCTYPE html>
<html>
<head>
    <title>Debug Timezone Issue</title>
    <style>
        body { font-family: monospace; padding: 20px; }
        .error { color: red; }
        .success { color: green; }
        .warning { color: orange; }
    </style>
</head>
<body>
    <h1>Timezone Debugging</h1>
    <p>Open browser console (F12) and look for detailed error logs</p>
    
    <div id="results"></div>
    
    <script>
        // Add a global function to debug task conversion
        window.debugTaskConversion = function() {
            console.log('=== Debugging Task Timezone Conversion ===');
            
            // Access the task store
            if (window.taskStore) {
                const tasks = window.taskStore.getState().tasks;
                console.log('Found tasks:', tasks.length);
                
                tasks.forEach((task, index) => {
                    console.log(`\n--- Task ${index + 1}: ${task.title} ---`);
                    console.log('Raw task data:', task);
                    
                    // Check for scheduling data
                    if (task.scheduledDate || task.scheduledTimeUTC) {
                        console.log('Scheduling info:');
                        console.log('  scheduledDate:', task.scheduledDate);
                        console.log('  scheduledStartTime:', task.scheduledStartTime);
                        console.log('  scheduledEndTime:', task.scheduledEndTime);
                        console.log('  scheduledTimeUTC:', task.scheduledTimeUTC);
                        console.log('  scheduledEndTimeUTC:', task.scheduledEndTimeUTC);
                        console.log('  includeTime:', task.includeTime);
                        
                        // Test timezone conversion
                        try {
                            if (window.TaskDisplayService) {
                                const displayTask = window.TaskDisplayService.convertForDisplay(task);
                                console.log('  -> Display conversion SUCCESS:', displayTask);
                            } else {
                                console.log('  -> TaskDisplayService not available');
                            }
                        } catch (error) {
                            console.error('  -> Display conversion FAILED:', error);
                        }
                    } else {
                        console.log('  -> No scheduling data');
                    }
                });
            } else {
                console.log('Task store not available');
            }
            
            // Check user timezone settings
            if (window.userStore) {
                const user = window.userStore.getState().user;
                console.log('\n=== User Settings ===');
                console.log('User timezone setting:', user?.settings?.timezone);
                console.log('Browser timezone:', Intl.DateTimeFormat().resolvedOptions().timeZone);
            }
        };
        
        // Auto-run after page loads
        setTimeout(() => {
            console.log('Timezone debugger loaded. Run window.debugTaskConversion() to debug.');
            document.getElementById('results').innerHTML = 
                '<p class="success">Debugger loaded. Check console and run: <code>window.debugTaskConversion()</code></p>';
        }, 1000);
    </script>
</body>
</html>