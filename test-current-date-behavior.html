<!DOCTYPE html>
<html>
<head>
    <title>Test Current Date Behavior</title>
</head>
<body>
    <h2>Current Date Creation Test</h2>
    <div id="results"></div>
    
    <script>
        // Simulate current system behavior
        function testCurrentDateCreation() {
            const now = new Date();
            const userTimezone = 'America/Los_Angeles';  // User setting
            const physicalTimezone = 'Asia/Bangkok';      // Physical location
            
            console.log('üîç Testing current date creation...');
            
            // Method 1: Current workSessionService approach
            // userNow = timezoneUtils.utcToUserTime(now.toISOString(), timezone)
            const userNow = new Date(now.toLocaleString('en-US', { timeZone: userTimezone }));
            const method1Date = userNow.toISOString().split('T')[0];
            
            // Method 2: Extension approach  
            const method2Date = now.toLocaleDateString('en-CA', { timeZone: userTimezone });
            
            // Method 3: Physical timezone (what we DON'T want)
            const physicalDate = now.toLocaleDateString('en-CA', { timeZone: physicalTimezone });
            
            // Method 4: Simple approach (what we want to test)
            const method4Date = new Date().toLocaleDateString('en-CA', { timeZone: userTimezone });
            
            const results = {
                currentTime: now.toISOString(),
                userTimezone,
                physicalTimezone,
                method1: method1Date,  // Current web app
                method2: method2Date,  // Current extension
                method3: physicalDate, // Wrong (physical)
                method4: method4Date   // Simple fix
            };
            
            console.log('Date creation test results:', results);
            
            // Display results
            document.getElementById('results').innerHTML = `
                <h3>Results:</h3>
                <p><strong>Current Time:</strong> ${results.currentTime}</p>
                <p><strong>User Timezone:</strong> ${results.userTimezone}</p>
                <p><strong>Physical Timezone:</strong> ${results.physicalTimezone}</p>
                <hr>
                <p><strong>Method 1 (Current Web):</strong> ${results.method1}</p>
                <p><strong>Method 2 (Current Ext):</strong> ${results.method2}</p>
                <p><strong>Method 3 (Physical - Wrong):</strong> ${results.method3}</p>
                <p><strong>Method 4 (Simple Fix):</strong> ${results.method4}</p>
                <hr>
                <p><strong>Consistency Check:</strong></p>
                <p>Method 1 == Method 2: ${results.method1 === results.method2 ? '‚úÖ' : '‚ùå'}</p>
                <p>Method 1 == Method 4: ${results.method1 === results.method4 ? '‚úÖ' : '‚ùå'}</p>
                <p>All methods use user timezone: ${(results.method1 === results.method2 && results.method2 === results.method4) ? '‚úÖ' : '‚ùå'}</p>
            `;
        }
        
        testCurrentDateCreation();
    </script>
</body>
</html>